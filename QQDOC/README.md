# 腾讯文档解析器

这是一个用于解析腾讯文档中电脑配件报价表的工具。

## 功能特点

- 自动解析腾讯文档中的报价信息
- 提取CPU、内存、存储等三大件的报价数据
- 按品牌、型号、价格进行整理
- 导出为Excel文件便于查看和分析
- 支持多种解析模式

## 文件说明

### 解析器文件
- `xlsx.py` - 基础解析程序
- `smart_parser.py` - 智能解析器（支持JSONP）
- `demo_parser.py` - 演示解析器（使用模拟数据）
- `simple_parser.py` - 简化版解析器
- `test_parser.py` - 测试解析器

### 配置文件
- `requirements.txt` - Python依赖包
- `start_parser.bat` - Windows启动脚本
- `data/` - 输出目录，解析结果将保存在这里

## 使用方法

### 方法一：使用启动脚本（推荐）

1. 双击运行 `start_parser.bat`
2. 选择运行模式：
   - 演示模式：使用模拟数据展示功能
   - 真实模式：尝试解析真实腾讯文档
   - 智能模式：使用多种方法解析
3. 解析结果将保存在 `data/` 目录中

### 方法二：手动运行

1. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

2. 运行解析器：
   ```bash
   # 演示模式
   python demo_parser.py
   
   # 真实模式
   python xlsx.py
   
   # 智能模式
   python smart_parser.py
   ```

## 输出格式

解析结果将保存为Excel文件，包含以下列：
- 品牌：产品品牌
- 型号：产品型号
- 价格：产品价格（元）

## 解析模式说明

### 演示模式 (demo_parser.py)
- 使用模拟数据展示解析功能
- 包含CPU、内存、存储、主板、显卡等配件
- 适合测试和演示

### 真实模式 (xlsx.py)
- 尝试直接访问腾讯文档API
- 可能受到访问限制
- 适合有权限的文档

### 智能模式 (smart_parser.py)
- 使用多种方法尝试解析
- 支持JSONP和API两种方式
- 最全面的解析能力

## 注意事项

1. 需要网络连接来访问腾讯文档
2. 确保Python环境已正确安装
3. 如果解析失败，可能需要手动检查文档访问权限
4. 演示模式可以随时运行，不受网络限制

## 技术说明

- 使用requests库进行HTTP请求
- 使用pandas进行数据处理
- 使用openpyxl保存Excel文件
- 支持多种数据格式的解析
- 支持JSONP和API两种数据获取方式

## 故障排除

如果遇到问题：

1. 检查网络连接
2. 确认Python版本（建议3.7+）
3. 检查依赖包是否正确安装
4. 查看控制台输出的错误信息
5. 尝试使用演示模式测试功能

## 更新日志

- v1.0: 初始版本，支持基本的腾讯文档解析功能
- v1.1: 添加演示模式，使用模拟数据展示功能
- v1.2: 添加智能模式，支持多种解析方法
- v1.3: 改进启动脚本，支持多种运行模式 