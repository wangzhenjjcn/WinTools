# 局域网IP端口扫描器

一个基于PyQt6的图形化局域网IP和端口扫描工具。

Copyright (c) 2024 wangzhenjjcn@gmail.com  
Author: wangzhenjjcn  
GitHub: https://github.com/wangzhenjjcn/WinTools

## 功能特点

- 图形化用户界面，操作简单
- 支持IP范围扫描
- 支持单个端口和端口范围扫描
- 可配置超时时间和线程数
- 实时显示扫描进度和结果
- 多线程并发扫描，提高效率
- **智能服务检测**：自动检测常见端口的服务类型
- **详细服务信息**：显示服务名称和版本信息
- **主机名显示**：自动检测并显示目标设备的主机名

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

1. 运行程序：
```bash
python ip_scanner.py
```

2. 在信息设置区配置扫描参数：

### 结果显示格式
扫描结果将显示为以下格式：
```
192.168.1.4:80 -HOSTNAME- HTTP ON (Apache/2.4.41)
192.168.1.4:22 -HOSTNAME- SSH ON (OpenSSH_8.2p1)
192.168.1.4:3306 -HOSTNAME- MySQL ON
192.168.1.4:6379 -HOSTNAME- Redis ON (Redis)
192.168.1.4:5000 -HOSTNAME- Synology-HTTP ON (Synology DSM)
```

其中：
- `IP:端口` - 目标地址和端口
- `HOSTNAME` - 目标设备的主机名（如果无法获取则显示为Unknown）
- `服务信息` - 检测到的服务类型和详细信息

3. 在信息设置区配置扫描参数：
   - **起始IP**: 扫描范围的起始IP地址（默认：192.168.0.1）
   - **结束IP**: 扫描范围的结束IP地址（默认：192.168.1.255）
   - **端口号**: 要扫描的端口，支持以下格式：
     - 单个端口：`80`
     - 多个端口：`80,443,3389`
     - 端口范围：`138-139`
     - 混合格式：`80,443,3389,138-139,3306,12345,5000-5001,21-23,445`
   - **检测常见端口**: 勾选后将自动检测所有常见端口，同时保留手动输入的端口
   - **超时**: 连接超时时间（毫秒，默认：1000ms，范围：100-9999ms）
   - **线程数**: 并发扫描线程数（默认：500，范围：1-9999）

3. 点击"开始扫描"按钮开始扫描

4. 在扫描结果区查看扫描结果

## 输入验证

程序会自动验证以下输入：

- IP地址格式必须正确（四段数字，每段0-255）
- 起始IP不能大于结束IP
- 端口号必须在1-65535范围内（或勾选检测常见端口）
- 超时时间必须在100-9999毫秒之间
- 线程数必须在1-9999之间

## 支持的服务检测

程序支持检测以下常见服务：

### Web服务
- **80端口** - HTTP服务（检测服务器类型）
- **443端口** - HTTPS服务
- **8080-8090端口** - HTTP代理/替代服务
- **8443-8450端口** - HTTPS替代服务
- **9000-9010端口** - HTTP替代服务
- **8000-8010端口** - HTTP替代服务

### 远程访问服务
- **22端口** - SSH服务（检测SSH版本）
- **23端口** - TELNET服务
- **3389端口** - RDP远程桌面服务
- **5900-5910端口** - VNC远程桌面服务
- **6000-6010端口** - X11图形界面服务

### 数据库服务
- **3306端口** - MySQL数据库服务
- **1433端口** - MSSQL数据库服务
- **1434端口** - MSSQL浏览器服务
- **1521端口** - Oracle数据库服务
- **5432端口** - PostgreSQL数据库服务
- **6379端口** - Redis缓存服务
- **27017端口** - MongoDB数据库服务
- **27018端口** - MongoDB分片服务
- **27019端口** - MongoDB配置服务
- **28017端口** - MongoDB Web界面
- **50000端口** - DB2数据库服务

### 文件服务
- **20端口** - FTP数据传输
- **21端口** - FTP服务（检测FTP服务器信息）
- **445端口** - SMB文件共享服务
- **548端口** - AFP文件服务

### 邮件服务
- **25端口** - SMTP邮件发送服务
- **465端口** - SMTPS安全邮件发送服务
- **587端口** - SMTP提交服务
- **110端口** - POP3邮件接收服务
- **995端口** - POP3S安全邮件接收服务
- **143端口** - IMAP邮件服务
- **993端口** - IMAPS安全邮件服务

### 网络服务
- **53端口** - DNS域名解析服务
- **67端口** - DHCP服务器
- **68端口** - DHCP客户端
- **69端口** - TFTP文件传输服务
- **123端口** - NTP时间同步服务
- **135端口** - RPC远程过程调用
- **137端口** - NetBIOS名称服务
- **138端口** - NetBIOS数据报服务
- **139端口** - NetBIOS会话服务
- **161端口** - SNMP网络管理
- **162端口** - SNMP陷阱服务
- **389端口** - LDAP目录服务
- **636端口** - LDAPS安全目录服务
- **514端口** - Syslog系统日志服务
- **515端口** - LPR打印服务
- **520端口** - RIP路由协议
- **554端口** - RTSP流媒体服务
- **631端口** - IPP打印服务
- **1080端口** - SOCKS代理服务

### 群晖NAS服务
- **5000-5010端口** - 群晖HTTP/HTTPS管理界面

### 消息队列服务
- **5672端口** - AMQP消息队列
- **5671端口** - AMQPS安全消息队列
- **8161端口** - ActiveMQ管理界面

### 容器和云服务
- **6443端口** - Kubernetes API服务
- **7077端口** - Apache Spark服务
- **2181端口** - ZooKeeper服务

### 大数据服务
- **9200端口** - Elasticsearch搜索服务
- **9300端口** - Elasticsearch集群服务
- **50070端口** - Hadoop NameNode
- **50075端口** - Hadoop DataNode
- **50090端口** - Hadoop SecondaryNameNode

### 其他服务
- **5060端口** - SIP语音协议
- **5061端口** - SIPS安全语音协议
- **5984端口** - CouchDB数据库
- **11211端口** - Memcached缓存
- **7777端口** - 游戏服务器
- **8161端口** - ActiveMQ管理界面

## 注意事项

- 请确保您有权限扫描目标网络
- 大量并发连接可能会被防火墙拦截
- 建议在本地网络环境中使用
- 扫描时间取决于网络环境和目标数量
- 服务检测会增加扫描时间，但提供更详细的信息

## 系统要求

- Python 3.7+
- PyQt6
- Windows/Linux/macOS 